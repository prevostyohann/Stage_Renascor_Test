{% extends 'base.html.twig' %}
{% block title %}Search{% endblock %}
{% block body %}
<div class="p-4 font-sans bg-gray-50 min-h-screen">

    <div class="sticky top-0 z-50 bg-white py-4 border-b border-gray-200">
        {% set back_route = is_granted('ROLE_CLIENT') ? 'client_home' : (is_granted('ROLE_PRO') ? 'pro_home' : null) %}

        {% if back_route %}
            <a href="{{ path(back_route) }}" class="flex items-center text-blue-700 font-semibold hover:underline ml-4">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                </svg>
                Back
            </a>
            <img src="{{ asset('uploads/BloomCare.png') }}" alt="Logo" class="mx-auto h-10">
        {% endif %}
    </div>

    <div class="text-center my-6">
        
        <h1 class="text-3xl font-bold text-purple-700">Rechercher</h1>
    </div>

    <form method="GET" action="{{ path('app_office_list') }}" class="space-y-4 px-4">
        <input type="text" name="q" placeholder="Socio-esthéticienne, socio-coiffeur…" class="w-full border rounded-xl p-3 shadow-sm focus:ring-purple-500 focus:border-purple-500">
        <input type="text" name="address" placeholder="Lieu" class="w-full border rounded-xl p-3 shadow-sm focus:ring-purple-500 focus:border-purple-500">
        <button type="submit" class="w-full bg-blue-600 text-white rounded-xl py-3 font-semibold shadow hover:bg-blue-700 transition">Rechercher</button>
    </form>

    <div class="flex justify-around mt-4 px-4 text-sm text-gray-600">
        <a href="#" class="hover:text-purple-700">Filtres</a>
        <a href="#" class="hover:text-purple-700">Spécialité</a>
        <a href="#" class="hover:text-purple-700">Disponibilités</a>
    </div>

    {% if q or address %}
    <div class="mt-6 space-y-4 px-4">
        {% if offices is not empty %}
            {% for office in offices %}
                <a href="{{ path('app_office_show', {'id': office.id}) }}">
                <div class="bg-white rounded-xl shadow p-4 flex items-center space-x-4 hover:shadow-md transition mb-2">
                    <img src="{{ office.profilePhotoLink }}" alt="{{ office.businessName }}" class="w-16 h-16 rounded-full object-cover">
                    <div class="flex-1">
                        <h2 class="font-bold text-lg">{{ office.businessName }}</h2>
                        <p class="text-sm text-gray-600">
                        {% if office.professions|length > 0 %}
                            {{ office.professions|map(p => p.name)|join(', ') }}
                        {% else %}
                            Profession inconnue
                        {% endif %}
                        <br>
                            {{ office.officeAddress }}
                        </p>
                    </div>
                    
                        <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
                        </svg>
                    
                </div>
                </a>
            {% endfor %}
        {% else %}
            <p class="text-center text-gray-500">Aucun commerce disponible pour le moment.</p>
        {% endif %}
    </div>
{% endif %}

</div>
{% endblock %}
